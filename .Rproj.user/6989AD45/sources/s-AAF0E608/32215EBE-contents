#### Toto je skript pro nalosování pojmů pro test z výzkumných otázek

## Encoding: windows-1250
## Vytvořil: 2021-10-04 FrK
## Upravil:  2021-10-05 FrK

## NOTES:
#



# Hlavička ----------------------------------------------------------------

# Vyčištění paměti
rm(list = ls())

# Package
library(dplyr)
library(tibble)
library(readxl)
library(writexl)



# Vektor s pojmy a další potřebné proměnné --------------------------------

pojmy = c("pohlaví", "věk", "vzdělání", "příjem", "počet dětí", "počet osob v domácnosti",
          "počet knih v domácí knihovně",
          "délka spánku", "zdravotní stav", "spokojenost se životem",

          "míra samostatnosti", "znalost soc. služeb", "intenzita užívání soc. služeb",
          "frekvence užívání soc. služeb", "spokojenost se soc. službami", "zájem o politiku",
          "vlastnictví mobilního telefonu", "vlastnictví TV přijímače", "intenzita sledování TV",
          "intenzita užívání sociálních sítí",

          "uplatnění vlastní vůle při řešení situace",
          "předsudky", "lidská práva", "osobní svobody",
          "znalost právních norem",
          "znalost vlastních práv",
          "přijímání darů", "dávání darů",
          "podmínky poskytování služby",
          "možnosti poskytování služby",

          "osobní cíle", "informovanost", "porozumění obsahu a účelu smlouvy",
          "forma stížnosti", "způsob vyřízení stížnosti",
          "informovanost zaměstnanců o možnostech stížností",
          "evidence stížností", "prošetření vyřizování stížností",
          "příležitost využít běžně dostupné veřejné služby",
          "zprostředkování služeb",

          "kontakty s přirozeným sociálním prostředím",
          "vztahy s přirozeným sociálním prostředím",
          "počet zaměstnanců", "počet úvazků zaměstnanců",
          "kvalifikační požadavky na zaměstnance",
          "osobnostní předpoklady zaměstnanců",
          "zaškolování nových zaměstnanců", "kapacita služby",
          "pravidelné hodnocení zaměstnanců",
          "program dalšího vzdělávání zaměstnanců",

          "systém finančního oceňování zaměstnanců",
          "systém morálního oceňování zaměstnanců",
          "podpora zaměstnanců od nezávislého odborníka",
          "místo poskytování služby",
          "čas poskytování služby",
          "materiální podmínky služby", "technické podmínky služby",
          "hygienické podmínky služby",
          "důstojné prostředí", "nouzová situace",

          "havarijní situace", "řešení situace",
          "seznámení zaměstnanců s řešením nouzové situace",
          "seznámení klientů s řešením nouzové situace",
          "seznámení klientů s řešením havarijní situace",
          "kvalita služby", "poslání služby", "cíle služby",
          "odcizení", "sociální struktura",

          "sociální aktér", "bída", "blahobyt", "masa",
          "cirkulace elit", "marginalizace", "dav", "dědictví",
          "disent", "diskriminace",

          "distance", "degradace", "diferenciace", "dynamika", "elita", "gang",
          "sociální hierarchie", "status", "statusová inkonzistence", "instituce",

          "inteligence", "kariéra", "kasta", "klan", "kmen", "kolektiv", "klientelismus",
          "kolektiv", "komunita", "krystalizace statusu",

          "meritokracie", "sociální mobilita", "sociální nerovnost(i)", "organizace",
          "privilegium", "příbuzenství", "rodina", "sociální síť",
          "skupina", "sousedství",

          "společenství", "společnost", "spolek", "spravedlnost", "stabilita", "stát",
          "politická strana", "stratifikace", "třída", "adaptace",

          "agrese", "altruismus", "alokace", "askeze", "aspirace", "atraktivita",
          "autorita", "stereotyp", "dar", "důstojnost",

          "důvěra", "dysfunkce", "egoismus", "euforie", "existence", "exkluze", "funkce",
          "harmonie", "hodnota", "hra",

          "charisma", "chování", "individualismus", "indoktrinace", "infiltrace",
          "internalizace", "jednání", "kapitál", "kulturní kapitál", "ekonomický kapitál",

          "sociální kapitál", "spolupráce", "soutěž", "kompetence", "konflikt", "role",
          "konflikt rolí", "konformita", "konsensus (shoda)", "kontrola",

          "konvence", "kritika", "korupce", "loajalita", "motivace", "mravnost",
          "morálka", "násilí", "norma", "naděje",

          "odměna", "trest", "odpovědnost", "organizace", "otevřenost", "orientace",
          "ovlivňování", "paměť", "poslušnost", "postoj",

          "potenciál", "potřeba", "pověst", "povinnost", "praxe", "preference", "prestiž",
          "prostředí", "přátelství", "předsudek",

          "racionalita", "reciprocita", "regulace", "revoluce", "rezignace", "rovnováha",
          "rozhodování", "řád", "sankce", "socializace",

          "solidarita", "strategie", "svoboda", "systém", "tabu", "tolerance", "tradice",
          "sociální učení", "vlastnost", "vztah", "zájem"
          )  # Seznam pojmů

length(pojmy)  # kontrola počtu pojmů
nchar(pojmy)  # kontrola délky pojmů
nchar(pojmy) %>% max()



# Vytvoření seznamů studujících -------------------------------------------

# sudý týden
sudý = read_xls("seznamMTV1.xls") %>% select(1:3, email) %>%
  add_case(read_xls("seznamMV1Y-sudy.xls") %>% select(1:3, email))

# lichý týden
lichý = read_xls("seznamMV1.xls") %>% select(1:3, email) %>%
  add_case(read_xls("seznamMV1Y-lichy.xls") %>% select(1:3, email))



# Vylosování --------------------------------------------------------------

# Aby bylo losování 'reproducible', musíme zafixovat random seed:
set.seed(20211005)  # Vždy když dělám test, dám sem datum, kdy je test spuštěn

# NOTE: Musíme udělat nejdřív sudý a potom lichý týden.

## Sudý týden
# Předem si vytvoříme prázdnou matici pro losované pojmy
los = matrix(rep(".", 11 * nrow(sudý)), ncol = 11) %>% as_tibble()

# A cyklem to naplníme:
for (i in 1:nrow(sudý)) {
  vx = sample(pojmy, 10)
  for (j in 1:10) {
    los[i, (j+1)] = vx[j]
  }
  los[i, 1] = paste0(vx, collapse = ", ")
}
names(los) = c("c4s", paste0("P", 1:10))

# Spojíme 'administrativní data' s pojmy:
df = tibble(sudý, los)

# Uložení losovačky

write_xlsx(df, "test01_2021-10-05.xlsx")



## Lichý týden
# Aby bylo losování 'reproducible', musíme zafixovat random seed:
set.seed(20211012)  # Vždy když dělám test, dám sem datum, kdy je test spuštěn

# NOTE: Musíme udělat nejdřív sudý a potom lichý týden.

# Předem si vytvoříme prázdnou matici pro losované pojmy
los = matrix(rep(".", 11 * nrow(lichý)), ncol = 11) %>% as_tibble()

# A cyklem to naplníme:
for (i in 1:nrow(lichý)) {
  vx = sample(pojmy, 10)
  for (j in 1:10) {
    los[i, (j+1)] = vx[j]
  }
  los[i, 1] = paste0(vx, collapse = ", ")
}
names(los) = c("c4s", paste0("P", 1:10))

# Spojíme 'administrativní data' s pojmy:
df = tibble(lichý, los)

# Uložení losovačky

write_xlsx(df, "test01_2021-10-12.xlsx")



